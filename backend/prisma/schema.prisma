generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema", "relationJoins"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["pretrial_slim"]
}

model CaseRaw {
  internal_case_id                            String?
  gender                                      String?
  race                                        String?
  ethnicity                                   String?
  age_at_crime                                String?
  age_at_arrest                               String?
  court_name                                  String?
  court_ori                                   String?
  county_name                                 String?
  district                                    String?
  region                                      String?
  court_type                                  String?
  judge_name                                  String?
  offense_month                               String?
  offense_year                                String?
  arrest_month                                String?
  arrest_year                                 String?
  arrest_type                                 String?
  top_arrest_law                              String?
  top_arrest_article_section                  String?
  top_arrest_attempt_indicator                String?
  top_charge_at_arrest                        String?
  top_charge_severity_at_arrest               String?
  top_charge_weight_at_arrest                 String?
  top_charge_at_arrest_violent_felony_ind     String?
  case_type                                   String?
  first_arraign_date                          String?
  top_arraign_law                             String?
  top_arraign_article_section                 String?
  top_arraign_attempt_indicator               String?
  top_charge_at_arraign                       String?
  top_severity_at_arraign                     String?
  top_charge_weight_at_arraign                String?
  top_charge_at_arraign_violent_felony_ind    String?
  hate_crime_ind                              String?
  arraign_charge_category                     String?
  representation_type                         String?
  app_count_arraign_to_dispo_released         String?
  app_count_arraign_to_dispo_detained         String?
  app_count_arraign_to_dispo_total            String?
  def_attended_sched_pretrials                String?
  remanded_to_jail_at_arraign                 String?
  ror_at_arraign                              String?
  bail_set_and_posted_at_arraign              String?
  bail_set_and_not_posted_at_arraign          String?
  nmr_at_arraign                              String?
  release_decision_at_arraign                 String?
  representation_at_securing_order            String?
  pretrial_supervision_at_arraign             String?
  contact_pretrial_service_agency             String?
  electronic_monitoring                       String?
  travel_restrictions                         String?
  passport_surrender                          String?
  no_firearms_or_weapons                      String?
  maintain_employment                         String?
  maintain_housing                            String?
  maintain_school                             String?
  placement_in_mandatory_program              String?
  removal_to_hospital                         String?
  obey_order_of_protection                    String?
  obey_court_conditions_family_offense        String?
  other_nmr                                   String?
  order_of_protection                         String?
  first_bail_set_cash                         String?
  first_bail_set_credit                       String?
  first_insurance_company_bail_bond           String?
  first_secured_surety_bond                   String?
  first_secured_app_bond                      String?
  first_unsecured_surety_bond                 String?
  first_unsecured_app_bond                    String?
  first_partially_secured_surety_bond         String?
  partially_secured_surety_bond_perc          String?
  first_partially_secured_app_bond            String?
  partially_secured_app_bond_perc             String?
  bail_made_indicator                         String?
  warrant_ordered_btw_arraign_and_dispo       String?
  dat_wo_ws_prior_to_arraign                  String?
  first_bench_warrant_date                    String?
  non_stayed_wo                               String?
  num_of_stayed_wo                            String?
  num_of_row                                  Int?
  docket_status                               String?
  disposition_type                            String?
  disposition_detail                          String?
  dismissal_reason                            String?
  disposition_date                            String?
  most_severe_sentence                        String?
  top_conviction_law                          String?
  top_conviction_article_section              String?
  top_conviction_attempt_indicator            String?
  top_charge_at_conviction                    String?
  top_charge_severity_at_conviction           String?
  top_charge_weight_at_conviction             String?
  top_charge_at_conviction_violent_felony_ind String?
  days_arraign_remand_first_released          String?
  known_days_in_custody                       String?
  days_arraign_bail_set_to_first_posted       String?
  days_arraign_bail_set_to_first_release      String?
  days_arraign_to_dispo                       String?
  ucmslivedate                                String?
  prior_vfo_cnt                               String?
  prior_nonvfo_cnt                            String?
  prior_misd_cnt                              String?
  pend_vfo                                    String?
  pend_nonvfo                                 String?
  pend_misd                                   String?
  supervision                                 String?
  rearrest                                    String?
  rearrest_date                               String?
  rearrest_firearm                            String?
  rearrest_date_firearm                       String?
  arr_cycle_id                                String?
  case_raw_id                                 String  @id(map: "cases_raw_pk") @default(dbgenerated("gen_random_uuid()")) @db.Uuid

  @@map("cases_raw")
  @@schema("pretrial_slim")
}

model Percentile {
  percentile_id    String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  judge_id         String   @db.Uuid
  percentile_type  String
  percentile_value Decimal? @db.Decimal
  judge            Judge    @relation(fields: [judge_id], references: [judge_id], onDelete: NoAction, onUpdate: NoAction)

  @@map("percentiles")
  @@schema("pretrial_slim")
}

model BailStatistics {
  bail_stat_id     String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  judge_id         String   @db.Uuid
  total_bail_set   Decimal? @default(0) @db.Decimal
  average_bail_set Decimal? @default(0) @db.Decimal
  median_bail_set  Decimal? @default(0) @db.Decimal
  severity         String?
  race             String?
  judge            Judge    @relation(fields: [judge_id], references: [judge_id], onDelete: NoAction, onUpdate: NoAction)

  @@map("bail_statistics")
  @@schema("pretrial_slim")
}

model ArraignmentStatistics {
  arraignment_stat_id String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  judge_id            String   @db.Uuid
  stat_type           String
  severity            String
  count               Int?     @default(1)
  percentage          Decimal? @default(0) @db.Decimal
  race                String?
  judge               Judge    @relation(fields: [judge_id], references: [judge_id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([judge_id, stat_type, severity, race])
  @@map("arraignment_statistics")
  @@schema("pretrial_slim")
}

// BASE MODELS

model Bail {
  bail_id                             String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  first_bail_set_cash                 String?
  first_bail_set_credit               String?
  first_insurance_company_bail_bond   String?
  first_secured_surety_bond           String?
  first_secured_app_bond              String?
  first_unsecured_surety_bond         String?
  first_unsecured_app_bond            String?
  first_partially_secured_surety_bond String?
  partially_secured_surety_bond_perc  String?
  first_partially_secured_app_bond    String?
  partially_secured_app_bond_perc     String?
  bail_made_indicator                 String?
  case_count                          Int     @default(1)
  cases                               Case[]

  @@map("bails")
  @@schema("pretrial_slim")
}

model Case {
  case_id                String              @id(map: "cases_pk") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  internal_case_id       String?
  case_type              String?
  court_id               String?             @db.Uuid
  judge_id               String?             @db.Uuid
  county_id              String?             @db.Uuid
  defendant_id           String?             @db.Uuid
  appearance_id          String?             @db.Uuid
  condition_id           String?             @db.Uuid
  bail_id                String?             @db.Uuid
  warrant_id             String?             @db.Uuid
  disposition_id         String?             @db.Uuid
  calculated_days_id     String?             @db.Uuid
  prior_id               String?             @db.Uuid
  arrest_id              String?             @db.Uuid
  Appearance             Appearance?         @relation(fields: [appearance_id], references: [appearance_id])
  Bail                   Bail?               @relation(fields: [bail_id], references: [bail_id])
  CalculatedDays         CalculatedDays?     @relation(fields: [calculated_days_id], references: [calculated_days_id])
  Conditions             Conditions?         @relation(fields: [condition_id], references: [condition_id])
  County                 County?             @relation(fields: [county_id], references: [county_id])
  Court                  Court?              @relation(fields: [court_id], references: [court_id])
  Defendant              Defendant?          @relation(fields: [defendant_id], references: [defendant_id])
  Disposition            Disposition?        @relation(fields: [disposition_id], references: [disposition_id])
  Judge                  Judge?              @relation(fields: [judge_id], references: [judge_id])
  Prior                  Prior?              @relation(fields: [prior_id], references: [prior_id])
  Warrant                Warrant?            @relation(fields: [warrant_id], references: [warrant_id])
  Arrest                 Arrest?             @relation(fields: [arrest_id], references: [arrest_id])
  Conviction             Conviction?         @relation(fields: [conviction_id], references: [conviction_id])
  conviction_id          String?             @db.Uuid
  ArraignCharge          ArraignCharge?      @relation(fields: [arraign_charge_id], references: [arraign_charge_id])
  arraign_charge_id      String?             @db.Uuid
  ArraignmentOutcome     ArraignmentOutcome? @relation(fields: [arraignment_outcome_id], references: [arraignment_outcome_id])
  arraignment_outcome_id String?             @db.Uuid
  Representation         Representation?     @relation(fields: [representation_id], references: [representation_id])
  representation_id      String?             @db.Uuid
  Date                   CaseDetails?        @relation(fields: [date_id], references: [date_id])
  date_id                String?             @db.Uuid

  @@map("cases")
  @@schema("pretrial_slim")
}

model ArraignmentOutcome {
  arraignment_outcome_id             String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  remanded_to_jail_at_arraign        String?
  ror_at_arraign                     String?
  bail_set_and_posted_at_arraign     String?
  bail_set_and_not_posted_at_arraign String?
  nmr_at_arraign                     String?
  release_decision_at_arraign        String?
  case_count                         Int     @default(1)
  cases                              Case[]

  @@map("arraignment_outcomes")
  @@schema("pretrial_slim")
}

model Representation {
  representation_id                String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  representation_type              String?
  representation_at_securing_order String?
  case_count                       Int     @default(1)
  cases                            Case[]

  @@map("representations")
  @@schema("pretrial_slim")
}

model Appearance {
  appearance_id                       String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  app_count_arraign_to_dispo_released String?
  app_count_arraign_to_dispo_detained String?
  app_count_arraign_to_dispo_total    String?
  def_attended_sched_pretrials        String?
  case_count                          Int     @default(1)
  cases                               Case[]

  @@map("appearances")
  @@schema("pretrial_slim")
}

model Arrest {
  arrest_id                               String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  arrest_type                             String?
  top_arrest_law                          String?
  top_arrest_article_section              String?
  top_arrest_attempt_indicator            String?
  top_charge_at_arrest                    String?
  top_charge_severity_at_arrest           String?
  top_charge_weight_at_arrest             String?
  top_charge_at_arrest_violent_felony_ind String?
  case_count                              Int     @default(1)

  cases Case[]

  @@map("arrests")
  @@schema("pretrial_slim")
}

model CaseDetails {
  date_id                  String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  internal_case_id         String
  rearrest_date            String?
  offense_month            String?
  offense_year             String?
  arrest_month             String?
  arrest_year              String?
  rearrest_date_firearm    String?
  ucmslivedate             String?
  arr_cycle_id             String?
  disposition_date         String?
  first_bench_warrant_date String?
  first_arraign_date       String?
  cases                    Case[]

  @@map("case_details")
  @@schema("pretrial_slim")
}

// Charge at arraignment
model ArraignCharge {
  arraign_charge_id                        String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  case_type                                String?
  top_arraign_law                          String?
  top_arraign_article_section              String?
  top_arraign_attempt_indicator            String?
  top_charge_at_arraign                    String?
  top_severity_at_arraign                  String?
  top_charge_weight_at_arraign             String?
  top_charge_at_arraign_violent_felony_ind String?
  hate_crime_ind                           String?
  arraign_charge_category                  String?
  case_count                               Int     @default(1)
  cases                                    Case[]

  @@map("arraign_charges")
  @@schema("pretrial_slim")
}

// Day intervals
model CalculatedDays {
  calculated_days_id                     String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  days_arraign_remand_first_released     String?
  known_days_in_custody                  String?
  days_arraign_bail_set_to_first_posted  String?
  days_arraign_bail_set_to_first_release String?
  days_arraign_to_dispo                  String?
  case_count                             Int     @default(1)
  cases                                  Case[]

  @@map("calculated_days")
  @@schema("pretrial_slim")
}

// Conditions of NMR release
model Conditions {
  condition_id                         String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  pretrial_supervision_at_arraign      String?
  contact_pretrial_service_agency      String?
  electronic_monitoring                String?
  travel_restrictions                  String?
  passport_surrender                   String?
  no_firearms_or_weapons               String?
  maintain_employment                  String?
  maintain_housing                     String?
  maintain_school                      String?
  placement_in_mandatory_program       String?
  removal_to_hospital                  String?
  obey_order_of_protection             String?
  obey_court_conditions_family_offense String?
  other_nmr                            String?
  order_of_protection                  String?
  case_count                           Int     @default(1)
  cases                                Case[]

  @@map("conditions")
  @@schema("pretrial_slim")
}

model Conviction {
  conviction_id                               String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  top_conviction_law                          String?
  top_conviction_article_section              String?
  top_conviction_attempt_indicator            String?
  top_charge_at_conviction                    String?
  top_charge_severity_at_conviction           String?
  top_charge_weight_at_conviction             String?
  top_charge_at_conviction_violent_felony_ind String?
  case_count                                  Int     @default(1)
  cases                                       Case[]

  @@map("convictions")
  @@schema("pretrial_slim")
}

model County {
  county_id   String @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  county_name String @unique(map: "counties_county_name_key1")
  case_count  Int    @default(1)
  cases       Case[]

  @@map("counties")
  @@schema("pretrial_slim")
}

model Court {
  court_id    String @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  court_name  String @unique(map: "courts_court_name_key1")
  court_ori   String
  county_name String
  district    String
  region      String
  court_type  String
  cases       Case[]

  @@map("courts")
  @@schema("pretrial_slim")
}

model Defendant {
  defendant_id  String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  gender        String?
  race          String?
  ethnicity     String?
  age_at_crime  String?
  age_at_arrest String?
  case_count    Int     @default(1)
  cases         Case[]

  @@map("defendants")
  @@schema("pretrial_slim")
}

model Disposition {
  disposition_id       String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  docket_status        String?
  disposition_type     String?
  disposition_detail   String?
  dismissal_reason     String?
  most_severe_sentence String?
  case_count           Int     @default(1)
  cases                Case[]

  @@map("dispositions")
  @@schema("pretrial_slim")
}

model Judge {
  judge_id               String                  @id(map: "judges_pkey1") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  judge_name             String                  @unique(map: "judges_judge_name_key1")
  case_count             Int                     @default(1)
  primary_county         String?
  counties               Json[]
  arraignment_statistics ArraignmentStatistics[]
  bail_statistics        BailStatistics[]
  cases                  Case[]
  percentiles            Percentile[]

  @@map("judges")
  @@schema("pretrial_slim")
}

model Prior {
  prior_id         String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  prior_vfo_cnt    String?
  prior_nonvfo_cnt String?
  prior_misd_cnt   String?
  pend_vfo         String?
  pend_nonvfo      String?
  pend_misd        String?
  supervision      String?
  rearrest         String?
  rearrest_firearm String?
  case_count       Int     @default(1)
  cases            Case[]

  @@map("priors")
  @@schema("pretrial_slim")
}

model Warrant {
  warrant_id                            String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  warrant_ordered_btw_arraign_and_dispo String?
  dat_wo_ws_prior_to_arraign            String?
  non_stayed_wo                         String?
  num_of_stayed_wo                      String?
  num_of_row                            Int?
  case_count                            Int     @default(1)
  cases                                 Case[]

  @@map("warrants")
  @@schema("pretrial_slim")
}
